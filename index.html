<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Omo-Alhaji | Wall Affairs & Art Gallery</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&family=Playfair+Display:wght@900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
    <script src="https://js.paystack.co/v1/inline.js"></script>

    <style>
        :root {
            --primary: #fbbf24; --accent: #1e293b; --bg-dark: #0f172a; 
            --card-bg: #1e293b; --text-light: #f8fafc; --whatsapp: #22c55e; --danger: #ef4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg-dark); color: var(--text-light); line-height: 1.6; }

        nav {
            background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(15px); padding: 1rem 5%;
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .brand { font-family: 'Playfair Display', serif; font-size: 1.8rem; font-weight: 900; color: var(--text-light); text-decoration: none; }
        .brand span { color: var(--primary); }

        .nav-actions { display: flex; align-items: center; gap: 20px; }
        .cart-btn { background: none; border: none; color: white; cursor: pointer; position: relative; display: flex; }
        .cart-count { position: absolute; top: -8px; right: -8px; background: var(--primary); color: var(--bg-dark); padding: 2px 6px; border-radius: 50%; font-size: 0.65rem; font-weight: 800; }

        .hero {
            height: 45vh;
            background: linear-gradient(to bottom, rgba(15,23,42,0.4), var(--bg-dark)), 
                        url('https://images.unsplash.com/photo-1579783902614-a3fb3927b6a5?auto=format&fit=crop&w=1200&q=80');
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;
        }

        .section-title { text-align: center; margin: 3rem 0 1.5rem; font-family: 'Playfair Display'; font-size: 2.2rem; color: var(--primary); }
        
        /* Testimonials Styles */
        .testimonials-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; padding: 0 5% 2rem; max-width: 1400px; margin: auto; }
        .testi-card { background: rgba(255,255,255,0.03); padding: 1.5rem; border-radius: 15px; border-left: 4px solid var(--primary); }
        .stars { color: var(--primary); margin-bottom: 10px; font-size: 0.9rem; }
        .client-name { display: block; margin-top: 15px; font-weight: 800; font-size: 0.85rem; color: var(--primary); }

        .catalog-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem; padding: 0 5% 4rem; max-width: 1400px; margin: auto; }
        .item-card { background: var(--card-bg); border-radius: 15px; overflow: hidden; transition: 0.3s; border: 1px solid rgba(255,255,255,0.05); }
        .item-card:hover { transform: translateY(-10px); border-color: var(--primary); }
        .item-img { height: 230px; width: 100%; object-fit: cover; }
        .item-info { padding: 1.2rem; }
        .item-price { color: var(--primary); font-weight: 800; font-size: 1.1rem; margin: 8px 0; }

        .admin-sec { display: none; padding: 4rem 5%; background: #000; border-top: 1px solid var(--primary); }
        .data-table { width: 100%; border-collapse: collapse; margin-top: 20px; background: var(--bg-dark); border-radius: 10px; overflow: hidden; font-size: 0.85rem; }
        .data-table th, .data-table td { padding: 12px; text-align: left; border-bottom: 1px solid #334155; }
        .data-table th { background: var(--accent); color: var(--primary); }

        .btn { width: 100%; padding: 12px; border-radius: 8px; border: none; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-primary { background: var(--primary); color: var(--bg-dark); }
        .btn-sm { padding: 6px 12px; font-size: 0.7rem; width: auto; margin-right: 5px; }
        .btn-danger { background: var(--danger); color: white; }

        .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center; z-index: 3000; }
        .modal-card { background: var(--card-bg); padding: 2rem; border-radius: 20px; width: 95%; max-width: 450px; position: relative; }
        .modal-card input { width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; }
        
        .modal-tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 1px solid #334155; padding-bottom: 10px; }
        .tab-btn { background: none; border: none; color: #94a3b8; cursor: pointer; font-weight: 600; padding: 5px 10px; }
        .tab-btn.active { color: var(--primary); border-bottom: 2px solid var(--primary); }

        .wa-float { position: fixed; bottom: 30px; right: 30px; background: var(--whatsapp); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 2000; }
    </style>
</head>
<body>

    <nav>
        <a href="#" class="brand">OMO-<span>ALHAJI</span></a>
        <div class="nav-actions">
            <button class="cart-btn" onclick="openCart()">
                <span class="material-symbols-rounded">shopping_bag</span>
                <span class="cart-count" id="cartCount">0</span>
            </button>
            <button class="btn-primary" id="userBtn" style="padding: 8px 18px; border-radius: 50px;" onclick="toggleModal('loginModal')">
                <span id="userBtnText">Login</span>
            </button>
        </div>
    </nav>

    <header class="hero">
        <h1 style="font-family: 'Playfair Display'; font-size: clamp(2rem, 5vw, 3.5rem);">Omo-Alhaji Art Gallery</h1>
        <p style="opacity: 0.8; letter-spacing: 2px; font-size: 0.8rem;">PREMIUM WALL AFFAIRS • PAINT PRODUCTION</p>
    </header>

    <section id="testimonials">
        <h2 class="section-title">Client Love</h2>
        <div class="testimonials-grid">
            <div class="testi-card">
                <div class="stars">★★★★★</div>
                <p>"The Satin Finish Paint transformed my living room completely. Incredible quality!"</p>
                <span class="client-name">- Mrs. Adebayo</span>
            </div>
            <div class="testi-card">
                <div class="stars">★★★★★</div>
                <p>"Best wallpaper collection in Lagos. The 3D Damask is simply stunning on my office walls."</p>
                <span class="client-name">- Joshua D.</span>
            </div>
            <div class="testi-card">
                <div class="stars">★★★★★</div>
                <p>"Professional service and top-tier art frames. My gallery looks world-class now."</p>
                <span class="client-name">- Kunle Alabi</span>
            </div>
        </div>
    </section>

    <section id="catalog">
        <h2 class="section-title">The Collection</h2>
        <div class="catalog-grid" id="catalogGrid"></div>
    </section>

    <section id="adminSection" class="admin-sec">
        <h2 class="section-title">Global Order Manager</h2>
        <div style="overflow-x: auto;">
            <table class="data-table">
                <thead><tr><th>Date</th><th>Customer</th><th>Items</th><th>Total</th><th>Actions</th></tr></thead>
                <tbody id="adminOrderTable"></tbody>
            </table>
        </div>
    </section>

    <div class="modal-overlay" id="loginModal">
        <div class="modal-card">
            <h2 id="modalTitle">Gallery Login</h2>
            <form id="authForm">
                <input type="email" id="loginEmail" placeholder="Email Address" required>
                <input type="password" id="loginPass" placeholder="Password" required>
                <button type="submit" class="btn btn-primary" style="margin-top: 20px;" id="authBtn">Sign In</button>
            </form>
            <p style="text-align: center; margin-top: 15px; font-size: 0.8rem;">
                <a href="javascript:void(0)" id="switchAuth" style="color: var(--primary);">New here? Create Account</a>
            </p>
            <button class="btn" style="color:#94a3b8; margin-top:10px;" onclick="toggleModal('loginModal')">Close</button>
        </div>
    </div>

    <div class="modal-overlay" id="cartModal">
        <div class="modal-card">
            <div class="modal-tabs">
                <button class="tab-btn active" id="tabCart" onclick="switchTab('cart')">Current Bag</button>
                <button class="tab-btn" id="tabHistory" onclick="switchTab('history')">Order History</button>
            </div>
            <div id="viewCart">
                <div id="cartItems" style="margin: 10px 0; min-height: 100px;"></div>
                <div id="cartTotal" style="font-size: 1.5rem; font-weight: 800; margin: 15px 0;">Total: ₦0</div>
                <button class="btn btn-primary" onclick="payWithPaystack()">Checkout with Paystack</button>
            </div>
            <div id="viewHistory" style="display: none;">
                <div id="userOrderList" style="max-height: 300px; overflow-y: auto; font-size: 0.85rem;"></div>
            </div>
            <button class="btn" onclick="toggleModal('cartModal')" style="color: white; margin-top: 15px; border: 1px solid rgba(255,255,255,0.1);">Close</button>
        </div>
    </div>

    <a href="https://wa.me/2348135942500" class="wa-float" target="_blank">
        <svg width="30" height="30" fill="white" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L0 24l6.335-1.662c1.72.937 3.659 1.435 5.63 1.435h.008c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
    </a>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, updateDoc, doc, serverTimestamp, query, orderBy, where } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCWv4pF_5hVBqYLl4MZIvndWq5slckZ-1E",
            authDomain: "omo-alhaji.firebaseapp.com",
            projectId: "omo-alhaji",
            storageBucket: "omo-alhaji.firebasestorage.app",
            messagingSenderId: "373858886528",
            appId: "1:373858886528:web:fac1898e827bc08d26d765"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let isLoginMode = true;

        document.getElementById('authForm').onsubmit = async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const pass = document.getElementById('loginPass').value;
            try {
                if (isLoginMode) await signInWithEmailAndPassword(auth, email, pass);
                else await createUserWithEmailAndPassword(auth, email, pass);
                toggleModal('loginModal');
            } catch (err) { alert(err.message); }
        };

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            document.getElementById('userBtnText').innerText = user ? user.email.split('@')[0].toUpperCase() : "Login";
            if (user) {
                loadUserOrders(user.email);
                if (user.email === "femidadajoshua@gmail.com") {
                    document.getElementById('adminSection').style.display = "block";
                    loadAdminOrders();
                }
            } else {
                document.getElementById('adminSection').style.display = "none";
                document.getElementById('userOrderList').innerHTML = `<p style="opacity:0.5; text-align:center; padding: 20px;">Log in to see your orders.</p>`;
            }
        });

        window.saveOrderToDb = async (ref, items, total) => {
            await addDoc(collection(db, "orders"), {
                email: currentUser ? currentUser.email : "Guest",
                items: items.map(i => i.title).join(", "),
                total: total,
                ref: ref,
                status: "Paid/Processing",
                createdAt: serverTimestamp()
            });
            if(currentUser) loadUserOrders(currentUser.email);
            if(currentUser?.email === "femidadajoshua@gmail.com") loadAdminOrders();
        };

        async function loadUserOrders(email) {
            const q = query(collection(db, "orders"), where("email", "==", email), orderBy("createdAt", "desc"));
            const snap = await getDocs(q);
            const list = document.getElementById('userOrderList');
            list.innerHTML = snap.empty ? "<p style='padding:20px; text-align:center;'>No orders found.</p>" : "";
            snap.forEach(d => {
                const o = d.data();
                list.innerHTML += `
                <div style="border-bottom: 1px solid rgba(255,255,255,0.1); padding: 10px 0;">
                    <div style="display:flex; justify-content:space-between; font-weight:800; color:var(--primary);">
                        <span>${o.createdAt?.toDate().toLocaleDateString() || 'Pending'}</span>
                        <span>₦${o.total.toLocaleString()}</span>
                    </div>
                    <div style="font-size: 0.75rem; opacity: 0.8;">${o.items}</div>
                </div>`;
            });
        }

        async function loadAdminOrders() {
            const q = query(collection(db, "orders"), orderBy("createdAt", "desc"));
            const snap = await getDocs(q);
            const table = document.getElementById('adminOrderTable');
            table.innerHTML = "";
            snap.forEach(d => {
                const o = d.data();
                table.innerHTML += `<tr><td>${o.createdAt?.toDate().toLocaleDateString() || '...'}</td><td>${o.email}</td><td>${o.items}</td><td>₦${o.total.toLocaleString()}</td><td>
                    <button class="btn btn-sm btn-primary" onclick="updateStatus('${d.id}', 'Shipped')">Ship</button>
                    <button class="btn btn-sm btn-danger" onclick="deleteOrder('${d.id}')">X</button>
                </td></tr>`;
            });
        }

        window.updateStatus = async (id, stat) => { await updateDoc(doc(db, "orders", id), { status: stat }); loadAdminOrders(); };
        window.deleteOrder = async (id) => { if(confirm("Delete order?")) { await deleteDoc(doc(db, "orders", id)); loadAdminOrders(); } };
        window.toggleModal = (id) => { const m = document.getElementById(id); m.style.display = (m.style.display === 'flex') ? 'none' : 'flex'; };
        window.getCurrentUserEmail = () => currentUser ? currentUser.email : "guest@omoalhaji.com";
        
        window.switchTab = (target) => {
            const viewCart = document.getElementById('viewCart');
            const viewHistory = document.getElementById('viewHistory');
            const tabCart = document.getElementById('tabCart');
            const tabHistory = document.getElementById('tabHistory');
            if (target === 'cart') {
                viewCart.style.display = 'block'; viewHistory.style.display = 'none';
                tabCart.classList.add('active'); tabHistory.classList.remove('active');
            } else {
                viewCart.style.display = 'none'; viewHistory.style.display = 'block';
                tabHistory.classList.add('active'); tabCart.classList.remove('active');
            }
        };

        window.openCart = () => { switchTab('cart'); toggleModal('cartModal'); };
    </script>

    <script>
        const products = [
            { id: 1, title: "Satin Finish Paint", price: 45000, img: "https://images.unsplash.com/photo-1589939705384-5185137a7f0f?w=600" },
            { id: 2, title: "3D Damask Wallpaper", price: 15500, img: "https://images.unsplash.com/photo-1615529328331-f8917597711f?w=600" },
            { id: 3, title: "Metallic Art Frame", price: 28000, img: "https://images.unsplash.com/photo-1583941516510-09689874892c?w=600" },
            { id: 4, title: "Wall Screeding", price: 3500, img: "https://images.unsplash.com/photo-1513519245088-0e12902e5a38?w=600" },
            { id: 5, title: "Abstract Canvas", price: 85000, img: "https://images.unsplash.com/photo-1541963463532-d68292c34b19?w=600" },
            { id: 6, title: "Office Branding", price: 60000, img: "https://images.unsplash.com/photo-1626785774573-4b799315345d?w=600" }
        ];

        let cart = [];

        function render() {
            document.getElementById('catalogGrid').innerHTML = products.map(p => `
                <div class="item-card">
                    <img src="${p.img}" class="item-img">
                    <div class="item-info">
                        <h3>${p.title}</h3>
                        <div class="item-price">₦${p.price.toLocaleString()}</div>
                        <button class="btn btn-primary" onclick="addToCart(${p.id})">Add to Bag</button>
                    </div>
                </div>`).join('');
        }

        function addToCart(id) { cart.push(products.find(p => p.id === id)); updateCart(); openCart(); }
        function updateCart() {
            document.getElementById('cartCount').innerText = cart.length;
            const total = cart.reduce((s, i) => s + i.price, 0);
            document.getElementById('cartTotal').innerText = "Total: ₦" + total.toLocaleString();
            document.getElementById('cartItems').innerHTML = cart.length ? cart.map(i => `<div style="display:flex; justify-content:space-between; font-size:0.8rem; margin-bottom:8px;"><span>${i.title}</span><span>₦${i.price.toLocaleString()}</span></div>`).join('') : "<p style='opacity:0.5; text-align:center;'>Your bag is empty</p>";
        }

        function payWithPaystack() {
            if(!cart.length) return alert("Bag is empty");
            const total = cart.reduce((s, i) => s + i.price, 0);
            let handler = PaystackPop.setup({
                key: 'pk_test_08092261626cf8814529d479366e6c8888b50209', 
                email: window.getCurrentUserEmail(),
                amount: total * 100,
                callback: (res) => { 
                    saveOrderToDb(res.reference, cart, total);
                    alert("Payment Success!"); 
                    cart = []; updateCart(); switchTab('history');
                }
            });
            handler.openIframe();
        }
        render();
        updateCart();
    </script>
</body>
</html>
